<tool id="barrnap_0.6" name="Barrnap" version="0.6">
    <description>BAsic Rapid Ribosomal RNA Predictor</description>
    <requirements>
        <requirement type="package" version="0.6">barrnap</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <version_command>Barrnap --version</version_command>
    
    <command><![CDATA[
        barrnap
        --evalue $evalue
        $incseq
        $fasta_input
        --kingdom $organism
        >> out.gff
    ]]></command>
    <inputs>
        <param name="fasta_input" multiple="False" type="data" format="fasta" label="FASTA DNA sequences:"
            help="Chromosomes.fasta"/>
            
        <param name="organism" type="select" label="Your organism is:" 
                    help="bacteria (5S,23S,16S), eukaryotes (5S,5.8S,28S,18S), mitochondria (12S,16S) and archaea (5S,5.8S,23S,16S).">
                 <option value="bac">bacteria</option>
                 <option value="euk">eukaryotes</option>
                 <option value="mito">mitochondria</option>
                 <option value="arc">archaea</option>
            </param>

        <param name="incseq" type="boolean" checked="false" truevalue="--incseq" falsevalue=""
            label="Include FASTA input sequences in GFF3 output?" />

        <param name="evalue" type="float" size="20" value="1e-06" label="Similarity e-value cut-off"/>

    </inputs>
    <outputs>
            <data name="outfile" format="gff" from_work_dir="out.gff"/>
    </outputs>
    <tests>
        <test> 
            <param name="fasta_input" value="bacteria.fna" />
            <param name="organism" value="bac" />
            <param name="incseq" value="--incseq" />
            <param name="evalue" value="1e-06" />
            <output name="outfile" file="test_1.gff" ftype="gff"/>
        </test>
        <test>
            <param name="fasta_input" value="fungus.fna" />
            <param name="organism" value="euk" />
            <param name="evalue" value="1e-06" />
            <output name="outfile" file="test_2.gff" ftype="gff"/>
        </test>
        <test>
            <param name="fasta_input" value="mitochondria.fna" />
            <param name="organism" value="mito" />
            <param name="incseq" value="--incseq" />
            <param name="evalue" value="0.000000001" />
            <output name="outfile" file="test_3.gff" ftype="gff"/>
        </test>
        <test> 
            <param name="fasta_input" value="archaea.fna" />
            <param name="organism" value="arc" />
            <param name="incseq" value="--incseq" />
            <param name="evalue" value="1e-06" />
            <output name="outfile" file="test_4.gff" ftype="gff"/>
        </test>
        <test> 
            <param name="fasta_input" value="nohits.fna" />
            <param name="organism" value="bac" />
            <param name="incseq" value="--incseq" />
            <param name="evalue" value="1e-06" />
            <output name="outfile" file="test_5.gff" ftype="gff"/>
        </test>
    </tests>
    <help><![CDATA[
**What it does**

Barrnap predicts the location of ribosomal RNA genes in genomes. It supports bacteria (5S,23S,16S), archaea (5S,5.8S,23S,16S), mitochondria (12S,16S) and eukaryotes (5S,5.8S,28S,18S).

It takes FASTA DNA sequence as input, and write GFF3 as output. It uses the new NHMMER tool that comes with HMMER 3.1 for HMM searching in RNA:DNA style. NHMMER binaries for 64-bit Linux and Mac OS X are included and will be auto-detected. Multithreading is supported and one can expect roughly linear speed-ups with more CPUs.

**Caveats**

Barrnap does not do anything fancy. It has HMM models for each different rRNA gene. They are built from full length seed alignments.

-----

**Barrnap** is a Free and Open Source Software, see more details on the Barrnap_ Website.

.. _Barrnap: https://github.com/tseemann/barrnap/blob/master/README.md#barrnap

    ]]></help>
    <citations>
        <citation type="bibtex">@misc{Barrnap,
            author = {Torsten Seemann},
            title = {Barrnap 0.6 : rapid ribosomal RNA prediction},
            year = {2013},
            howpublished={https://github.com/Victorian-Bioinformatics-Consortium/barrnap}
        }</citation>
     </citations>
</tool>
